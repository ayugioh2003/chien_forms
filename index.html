<head>
  <title> 某某研究 </title>
</head> 

<!----------------------- 第一頁|指導語 -------------------------->

<!-- 表單開始處 -->
<form action="https://script.google.com/macros/s/AKfycbzk3Mu5S_ygkjnboLKJoqWHnFqOqTbUyIP3kcKXA9hYhLYvjg8/exec" id="myForm" method="post" onkeydown="if(event.keyCode==13){return false;}"   >
  <input type="hidden" name="method" value="write" />
  
  <div id="page1">
    <h1>某某研究</h1> 
    <p>
      我是xxx，ooo學校，正在進行???計畫的研究<br>  
      本研究想了解 blabla<br>
      作答約須二十分鐘<br>  
    </p>
    <br>
  您的 E-mail(必填)：<input type="text" name="email" placeholder="請填入 E-mail " title="填入email地址" id="input_page1"/><br/></br>
  <button type="button" onclick="check_page1()">開始作答(0/3)</button>
  <hr>
  </div>

<!-------------------- 第二頁|一、情感方格 ----------------------->  
  <div id="page2" style="display:none">
    <h2>一、情感方格</h2>
    <p>請依照情緒方格(The Affect Grid)的向度，來評估你當下的情緒</p>

    <div>(1) 請問你現在的心情？(14~24)(必填)</div>
    <div>
    (很不高興)
      <input type="radio" name="mood_1" id="ra1_14" value="14">
      <label for="mood">14</label>
      <input type="radio" name="mood_1" id="ra1_13" value="13">    
      <label for="mood">13</label>
      <input type="radio" name="mood_1" id="ra1_12" value="12">
      <label for="mood">12</label>
      <input type="radio" name="mood_1" id="ra1_11" value="11">
      <label for="mood">11</label>
      <input type="radio" name="mood_1" id="ra1_00" value="00">
      <label for="mood">00</label>
      <input type="radio" name="mood_1" id="ra1_21" value="21"> 
      <label for="mood">21</label>
      <input type="radio" name="mood_1" id="ra1_22" value="22">
      <label for="mood">22</label>
      <input type="radio" name="mood_1" id="ra1_23" value="23">  
      <label for="mood">23</label>
      <input type="radio" name="mood_1" id="ra1_24" value="24">
      <label for="mood">24</label>

      (很高興)</div>

    <br><br>
    <img src="https://i.imgur.com/Hm1VGS4.png" width="500" >   

    <br><br><br>
    <div>(2) 請問你的激動程度？(1~9)(必填)</div>
    <div>(很不激動)
      <input type="radio" name="arousal_1" id="ar1_1" value="1">
      <label for="mood">1</label>
      <input type="radio" name="arousal_1" id="ar1_2" value="2">    
      <label for="mood">2</label>
      <input type="radio" name="arousal_1" id="ar1_3" value="3">
      <label for="mood">3</label>
      <input type="radio" name="arousal_1" id="ar1_4" value="4">
      <label for="mood">4</label>
      <input type="radio" name="arousal_1" id="ar1_5" value="5">
      <label for="mood">5</label>
      <input type="radio" name="arousal_1" id="ar1_6" value="6"> 
      <label for="mood">6</label>
      <input type="radio" name="arousal_1" id="ar1_7" value="7">
      <label for="mood">7</label>
      <input type="radio" name="arousal_1" id="ar1_8" value="8">  
      <label for="mood">8</label>
      <input type="radio" name="arousal_1" id="ar1_9" value="9">
      <label for="mood">9</label>

    (很激動)
    </div><br>
    <img src="https://i.imgur.com/pZHGT4C.png" width="500" >  

    <br><br>
      <button type="button" onclick="check_page2()">下一頁面(1/3)</button> 
    <br>
    <hr>
  </div>
<!--------------------- 第三頁|二、書寫作業 ---------------------->

<div id="page3" >
    <div id="page3_guide" style="display:none">
    <h2>二、書寫作業</h2>  
      <p>
        填寫完個人資料後，請按「開始作答」按鈕進行書寫作業<br>
        作答時間二十分鐘(1200s)，時間到請停止作答<br>
      </p>

    <br/> 
    <input type="button" id="countbtn" value="開始作答(2/3)" onClick="timedCount();show(page3_text)">
     </div>

    <br/><br/>

    <div id="page3_text" style="display:none">
    <p>書寫區(必填)</p>
    <textarea name="text" placeholder="填入書寫內容" title="填入書寫內容" style="width:500px;height:200px;"></textarea><br>  
    <button type="button" id="textbtn" />  已作答時間 <input type="text" id="txt">   ) </button>
    <br><br>
    <hr>
    </div>
</div>

<!----------------- 第四頁|三、情感方格 --------------------------->

  <div id="page4" style="display:none">
    
    <h2>三、情感方格</h2>
    <p>請依照情緒方格(The Affect Grid)的向度，<strong>「再評估一次」</strong>你目前的情緒</p>


    <div>(1) 請問你現在的心情？(14~24)(必填)</div>
    <div>(很不高興)
      <input type="radio" name="mood_2" id="ra1_14" value="14">
      <label for="mood">14</label>
      <input type="radio" name="mood_2" id="ra1_13" value="13">    
      <label for="mood">13</label>
      <input type="radio" name="mood_2" id="ra1_12" value="12">
      <label for="mood">12</label>
      <input type="radio" name="mood_2" id="ra1_11" value="11">
      <label for="mood">11</label>
      <input type="radio" name="mood_2" id="ra1_00" value="00">
      <label for="mood">00</label>
      <input type="radio" name="mood_2" id="ra1_21" value="21"> 
      <label for="mood">21</label>
      <input type="radio" name="mood_2" id="ra1_22" value="22">
      <label for="mood">22</label>
      <input type="radio" name="mood_2" id="ra1_23" value="23">  
      <label for="mood">23</label>
      <input type="radio" name="mood_2" id="ra1_24" value="24">
      <label for="mood">24</label>

    (很高興)
    </div> 

    <br><br>
    <img src="https://i.imgur.com/Hm1VGS4.png" width="500" >   

    <br><br><br>
    <div>(2) 請問你的激動程度？(1~9)(必填)</div>
    <div>
      (很不激動)
      <input type="radio" name="arousal_2" id="ar1_1" value="1">
      <label for="mood">1</label>
      <input type="radio" name="arousal_2" id="ar1_2" value="2">    
      <label for="mood">2</label>
      <input type="radio" name="arousal_2" id="ar1_3" value="3">
      <label for="mood">3</label>
      <input type="radio" name="arousal_2" id="ar1_4" value="4">
      <label for="mood">4</label>
      <input type="radio" name="arousal_2" id="ar1_5" value="5">
      <label for="mood">5</label>
      <input type="radio" name="arousal_2" id="ar1_6" value="6"> 
      <label for="mood">6</label>
      <input type="radio" name="arousal_2" id="ar1_7" value="7">
      <label for="mood">7</label>
      <input type="radio" name="arousal_2" id="ar1_8" value="8">  
      <label for="mood">8</label>
      <input type="radio" name="arousal_2" id="ar1_9" value="9">
      <label for="mood">9</label>

    (很激動)</div><br>
    <img src="https://i.imgur.com/pZHGT4C.png" width="500" >  

    <br><br>
    <button type="button" value="提交" id="subbtn" onclick="check_page4()"/>提交</button>   
  </div>
</form>


<!------------------ 語法區 ------------------------> 
<script>
  // 計時書寫的時間，時間到執行某個指令
  var c=0
  var t
  
  function timedCount()
  {
    document.getElementById('txt').value=c
    c=c+1
      
    if(c==12){
      hide(page3)
      show(page4)
      // document.getElementById("myForm").submit()
      //document.getElementById("subbtn").click();
      //window.opener=null;
      //top.window.close();
    }
    document.getElementById("countbtn").disabled=true;
    t=setTimeout("timedCount()",1000)
  }
  
  // 必須填完選項才能換頁
  
  function check_page1(){
    
    var page1_alert = "請填入資料";
    var page1_value = document.getElementById("input_page1").value
    
    if(page1_value=null || page1_value==""){
       alert(page1_alert);
       return false;
    }
    else{
       hide(page1);
       show(page2);
     }
  }
  
  function check_page2(){
  
    var page2_alert = "請點擊選項";
    var mood1_value = document.getElementById('myForm').mood_1.value
    var arousal1_value = document.getElementById('myForm').arousal_1.value
    
    if( mood1_value && arousal1_value ){
      hide(page2);
      show(page3_guide);
    }
    else{
       alert(page2_alert);
       return false;
    }
  }
  
  function check_page4(){
  
    var page4_alert = "請點擊選項";
    var mood2_value = document.getElementById('myForm').mood_2.value
    var arousal2_value = document.getElementById('myForm').arousal_2.value
    
    if( mood2_value && arousal2_value ){
      document.getElementById("myForm").submit()
    }
    else{
       alert(page4_alert);
       return false;
    }
  }


  
  //點擊按鈕後，隱藏上一頁，打開下一頁
  
  var countbtn = "countbtn"
  var page1 = "page1"
  var page2 = "page2"
  var page3 = "page3"
  var page3_guide = "page3_guide"
  var page3_text = "page3_text"
  var page4 = "page4"
  
  function hide(obj){
    document.getElementById(obj).style.display="none";
  }
  function show(obj){
    document.getElementById(obj).style.display="inline";
  }
</script>
